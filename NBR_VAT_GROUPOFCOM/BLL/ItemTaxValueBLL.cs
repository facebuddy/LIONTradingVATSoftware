using System;
using System.Collections;
using System.Data;
using System.Runtime.CompilerServices;
namespace NBR_VAT_GROUPOFCOM.BLL
{
    public class ItemTaxValueBLL
    {
        private DBUtility DBUtil = new DBUtility();

        public string Session
        {
            get;
            set;
        }

        public ItemTaxValueBLL()
        {
        }

        public bool CheckLimitVatExists(int itemID, string transType)
        {
            bool flag = false;
            object[] objArray = new object[] { "select * from item_tax_values WHERE item_id = ", itemID, " AND ", transType, " = true AND tax_id=(select tax_id from item_tax_category where tax_code='Limit')" };
            string str = string.Concat(objArray);
            if (this.DBUtil.GetDataTable(str).Rows.Count > 0)
            {
                flag = true;
            }
            return flag;
        }

        public bool CheckPerVatExists(int itemID, string transType)
        {
            bool flag = false;
            object[] objArray = new object[] { "select * from item_tax_values WHERE item_id = ", itemID, " AND ", transType, " = true AND tax_id=(select tax_id from item_tax_category where tax_code='Per')" };
            string str = string.Concat(objArray);
            if (this.DBUtil.GetDataTable(str).Rows.Count > 0)
            {
                flag = true;
            }
            return flag;
        }

        public bool CheckVatExists(int itemID, string transType)
        {
            bool flag = false;
            object[] objArray = new object[] { "select * from item_tax_values WHERE item_id = ", itemID, " AND ", transType, " = true" };
            string str = string.Concat(objArray);
            if (this.DBUtil.GetDataTable(str).Rows.Count > 0)
            {
                flag = true;
            }
            return flag;
        }

        public bool deleteTaxValue(int intTaxValueId)
        {
            string str = string.Concat("UPDATE item_tax_values set Is_deleted='true' WHERE tax_value_id = '", intTaxValueId, "'");
            return this.DBUtil.ExecuteDML(str);
        }

        public DataSet getAllItemTaxValues(string strItemId)
        {
            string str = "";
            string[] strArrays = new string[] { "\r\n             --transaction type local\r\n            select hs_code,item_id, item_name,unit_code,date_effective,max(Cd)Cd,max(Rd)Rd,max(Sd)Sd, max(Vat)Vat,max(Ait)Ait,max(Atv)Atv,max(Tti)Tti,max(AT_)AT_,sum(trade_price)trade_price,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.tax_value CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='1'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n            \r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,0 as trade_price,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 trade_price ,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='111'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type\r\n           \r\n            --transaction type import\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,max(Cd)Cd,max(Rd)Rd,max(Sd)Sd, max(Vat)Vat,max(Ait)Ait,max(Atv)Atv,max(Tti)Tti,max(AT_)AT_ ,sum(trade_price)trade_price,trns_type \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.tax_value CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='1'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            union all\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            where i.Is_deleted=false ", strItemId, " AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            where i.Is_deleted=false ", strItemId, " AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,0 as trade_price,case when itv.is_tran_import=true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_import=true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 AS trade_price ,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='111'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_import=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type\r\n            --transaction type sale\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,max(Cd)Cd,max(Rd)Rd,max(Sd)Sd, max(Vat)Vat,max(Ait)Ait,max(Atv)Atv,max(Tti)Tti,max(AT_)AT_,sum(trade_price)trade_price,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.tax_value CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='1'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            union all\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale=true\r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale=true\r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,0 as trade_price,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale=true \r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true \r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 AS trade_price ,case when itv.is_tran_sale=true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='111'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_sale=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type\r\n            --trade price\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,max(Cd)Cd,max(Rd)Rd,max(Sd)Sd, max(Vat)Vat,max(Ait)Ait,max(Atv)Atv,max(Tti)Tti,max(AT_)AT_,sum(trade_price)trade_price,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.tax_value CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='1'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,0 as trade_price,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,0 as trade_price,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n\r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,itv.tax_value trade_price ,case when itv.is_trade_price=true then 'trade_price' end trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='111'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_trade_price=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type\r\n            order by item_name" };
            str = string.Concat(strArrays);
            return this.DBUtil.GetDataSet(str, "ItemTaxvalues");
        }

        public DataTable getAllItemTaxValuesForSelect(string strItemId, bool blcl, bool bimp, bool bsl, bool bTradePrice)
        {
            string str = "";
            if (blcl)
            {
                string[] strArrays = new string[] { "\r\n             --transaction type local\r\n            select hs_code,item_id, item_name,unit_code,date_effective,max(Cd)Cd,max(Rd)Rd,max(Sd)Sd, max(Vat)Vat,max(Ait)Ait,max(Atv)Atv,max(Tti)Tti,max(AT_)AT_,trns_type\r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.tax_value CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='1'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            union all\r\n\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type order by item_name" };
                str = string.Concat(strArrays);
            }
            if (bimp)
            {
                string[] strArrays1 = new string[] { "\r\n            select hs_code, item_id, item_name, unit_code, date_effective, max(Cd)Cd, max(Rd)Rd, max(Sd)Sd, max(Vat)Vat, max(Ait)Ait, max(Atv)Atv, max(Tti)Tti, max(AT_)AT_, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, itv.tax_value CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '1'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            union all\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n\t        union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type order by item_name" };
                str = string.Concat(strArrays1);
            }
            if (bsl)
            {
                string[] strArrays2 = new string[] { "\r\n            select hs_code, item_id, item_name, unit_code, date_effective, max(Cd)Cd, max(Rd)Rd, max(Sd)Sd, max(Vat)Vat, max(Ait)Ait, max(Atv)Atv, max(Tti)Tti, max(AT_)AT_, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, itv.tax_value CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '1'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            union all\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id, date_effective, trns_type\r\n            order by item_name" };
                str = string.Concat(strArrays2);
            }
            if (bTradePrice)
            {
                string[] strArrays3 = new string[] { "\r\n            select hs_code, item_id, item_name, unit_code, date_effective, max(Cd)Cd, max(Rd)Rd, max(Sd)Sd, max(Vat)Vat, max(Ait)Ait, max(Atv)Atv, max(Tti)Tti, max(AT_)AT_, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, itv.tax_value CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '1'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            union all\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            union all\r\n\r\n            select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id, date_effective, trns_type\r\n            order by item_name" };
                str = string.Concat(strArrays3);
            }
            return this.DBUtil.GetDataTable(str);
        }

        public DataTable getAllItemTaxValuesForSelectLimit(string strItemId, bool blcl, bool bimp, bool bsl, bool bTradePrice)
        {
            string str = "";
            if (blcl)
            {
                string[] strArrays = new string[] { "\r\n             --transaction type local\r\n            select hs_code,item_id,tax_id, item_name,unit_code unit_name,date_effective,sum(lower_limit) lower_limit,sum(upper_limit) upper_limit,SUM(tax_value) vat_amount,trns_type,per\r\n            from (\r\n            select i.hs_code,i.item_id,itv.tax_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.lower_limit,itv.upper_limit,itv.tax_value,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=999\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n             --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n             --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n             --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,tax_id,date_effective,trns_type,per order by item_name" };
                str = string.Concat(strArrays);
            }
            if (bimp)
            {
                string[] strArrays1 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective, per,sum(lower_limit) lower_limit,sum(upper_limit) upper_limit,SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per,itv.lower_limit,itv.upper_limit, itv.tax_value,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 999\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 99\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,tax_id,date_effective,trns_type,per order by item_name" };
                str = string.Concat(strArrays1);
            }
            if (bsl)
            {
                string[] strArrays2 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective,per,sum(lower_limit) lower_limit,sum(upper_limit) upper_limit, SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per, itv.lower_limit,itv.upper_limit,itv.tax_value,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 999\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id,tax_id, date_effective,trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays2);
            }
            if (bTradePrice)
            {
                string[] strArrays3 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective,per,sum(lower_limit) lower_limit,sum(upper_limit) upper_limit, SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per, itv.lower_limit,itv.upper_limit,itv.tax_value,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 999\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id,tax_id, date_effective, trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays3);
            }
            return this.DBUtil.GetDataTable(str);
        }

        public DataTable getAllItemTaxValuesForSelectPer(string strItemId, bool blcl, bool bimp, bool bsl, bool bTradePrice)
        {
            string str = "";
            if (blcl)
            {
                string[] strArrays = new string[] { "\r\n             --transaction type local\r\n            select hs_code,item_id,tax_id, item_name,unit_code unit_name,date_effective,SUM(tax_value) vat_amount,trns_type,per\r\n            from (\r\n            select i.hs_code,i.item_id,itv.tax_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=99\r\n            where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,itv.tax_value RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='2'\r\n             --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,itv.tax_value Sd,0 Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='3'\r\n             --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n             --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n             --from Item i left outer join\r\n             --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n             --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='4'\r\n             --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --added by mohi uddin on 19-Aug-2019\r\n            --the item that has per or upper limit and lower limit \r\n            --union all\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,itv.tax_value Vat,0 Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='99'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,itv.tax_value Ait, 0 Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='5'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, itv.tax_value Atv,0 Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='6'\r\n            --where i.Is_deleted=false", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,itv.tax_value Tti,0 AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='7'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,0 CD,0 RD,0 Sd,0 Vat,0 Ait, 0 Atv,0 Tti,itv.tax_value AT_,case when itv.is_tran_local=true then 'local_purchase' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id='8'\r\n            --where i.Is_deleted=false ", strItemId, "  AND itv.is_current  = true AND itv.is_tran_local=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,tax_id,date_effective,trns_type,per order by item_name" };
                str = string.Concat(strArrays);
            }
            if (bimp)
            {
                string[] strArrays1 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective, per,SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per, itv.tax_value,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 99\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 99\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_import = true then 'import' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_import = true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,tax_id,date_effective,trns_type,per order by item_name" };
                str = string.Concat(strArrays1);
            }
            if (bsl)
            {
                string[] strArrays2 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective,per, SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per, itv.tax_value,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 99\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --added by mohi uddin on 19 - Aug - 2019\r\n            --the item that has per or upper limit and lower limit\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '99'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, itv.tax_value Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '5'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, itv.tax_value Atv, 0 Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '6'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, itv.tax_value Tti, 0 AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '7'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, itv.tax_value AT_,case when itv.is_tran_sale = true then 'sale' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '8'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_tran_sale = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id,tax_id, date_effective,trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays2);
            }
            if (bTradePrice)
            {
                string[] strArrays3 = new string[] { "\r\n            select hs_code, item_id,tax_id, item_name, unit_code unit_name, date_effective,per, SUM(tax_value) vat_amount, trns_type\r\n            from(\r\n            select i.hs_code, i.item_id,itv.tax_id, i.item_name, iu.unit_code, itv.date_effective,itv.per, itv.tax_value,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = 99\r\n            where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, itv.tax_value RD, 0 Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '2'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, itv.tax_value Sd, 0 Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '3'\r\n            --where i.Is_deleted = false ", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n\r\n            --union all\r\n\r\n            --select i.hs_code, i.item_id, i.item_name, iu.unit_code, itv.date_effective, 0 CD, 0 RD, 0 Sd, itv.tax_value Vat, 0 Ait, 0 Atv, 0 Tti, 0 AT_,case when itv.is_trade_price = true then 'trade_price' end  trns_type\r\n            --from Item i left outer join\r\n            --item_unit iu on i.unit_id = iu.unit_id left outer join\r\n            --item_tax_values itv on i.Item_id = itv.Item_id and itv.tax_id = '4'\r\n            --where i.Is_deleted = false", strItemId, "  AND itv.is_current = true AND itv.is_trade_price = true\r\n            ) item_tax group by hs_code, item_name, unit_code, item_id,tax_id, date_effective, trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays3);
            }
            return this.DBUtil.GetDataTable(str);
        }

        public DataSet GetAllItemTaxValuesLimit(string strItemId)
        {
            DataSet dataSet;
            try
            {
                string str = "";
                string[] strArrays = new string[] { "\r\n                --transaction type local\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,SUM(lower_limit) AS lower_limit,SUM(upper_limit) AS upper_limit,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,itv.lower_limit,itv.upper_limit,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id = 999\r\n            where i.Is_deleted=false  ", strItemId, " AND itv.is_current  = true AND itv.is_tran_local=true\r\n                        \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n           \r\n            --transaction type import\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,SUM(lower_limit) AS lower_limit,SUM(upper_limit) AS upper_limit,max(tax_value) tax_value,trns_type \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,itv.lower_limit,itv.upper_limit,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=999\r\n            where i.Is_deleted=false    ", strItemId, " AND itv.is_current  = true AND itv.is_tran_import=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            --transaction type sale\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,SUM(lower_limit) AS lower_limit,SUM(upper_limit) AS upper_limit,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,itv.lower_limit,itv.upper_limit,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=999\r\n            where i.Is_deleted=false ", strItemId, " AND itv.is_current  = true AND itv.is_tran_sale=true\r\n         \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            --trade price\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,SUM(lower_limit) AS lower_limit,SUM(upper_limit) AS upper_limit,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.lower_limit,itv.upper_limit,itv.tax_value,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=999\r\n            where i.Is_deleted=false ", strItemId, " AND itv.is_current  = true AND itv.is_trade_price=true\r\n                      \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays);
                dataSet = this.DBUtil.GetDataSet(str, "ItemTaxvalues");
            }
            catch (Exception exception)
            {
                Console.WriteLine(exception);
                throw;
            }
            return dataSet;
        }

        public DataSet getAllItemTaxValuesPer(string strItemId)
        {
            DataSet dataSet;
            try
            {
                string str = "";
                string[] strArrays = new string[] { "\r\n              --transaction type local\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,case when itv.is_tran_local=true then 'Local_purchase' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id = 99\r\n            where i.Is_deleted=false  ", strItemId, " AND itv.is_current  = true AND itv.is_tran_local=true\r\n                        \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n           \r\n            --transaction type import\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,max(tax_value) tax_value,trns_type \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,case when itv.is_tran_import=true then 'Import' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=99\r\n            where i.Is_deleted=false  ", strItemId, " AND itv.is_current  = true AND itv.is_tran_import=true\r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            --transaction type sale\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,case when itv.is_tran_sale=true then 'Sale' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=99\r\n            where i.Is_deleted=false  ", strItemId, " AND itv.is_current  = true AND itv.is_tran_sale=true\r\n         \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            --trade price\r\n            union all\r\n            select hs_code,item_id, item_name,unit_code,date_effective,per,max(tax_value) tax_value,trns_type  \r\n            from (\r\n            select i.hs_code,i.item_id,i.item_name,iu.unit_code,itv.date_effective,itv.per,itv.tax_value,case when itv.is_trade_price=true then 'Trade_price' end  trns_type\r\n            from Item i left outer join\r\n            item_unit iu on i.unit_id=iu.unit_id left outer join\r\n            item_tax_values itv on i.Item_id=itv.Item_id and itv.tax_id=99\r\n            where i.Is_deleted=false  ", strItemId, " AND itv.is_current  = true AND itv.is_trade_price=true\r\n                      \r\n            ) item_tax group by hs_code,item_name, unit_code,item_id,date_effective,trns_type,per\r\n            order by item_name" };
                str = string.Concat(strArrays);
                dataSet = this.DBUtil.GetDataSet(str, "ItemTaxvalues");
            }
            catch (Exception exception)
            {
                Console.WriteLine(exception);
                throw;
            }
            return dataSet;
        }

        public DataTable getItemHSCodedByItemId(int intItemId)
        {
            string str = string.Concat("select is_healthcare_surcharge,hs_code,unit_name from Item I,item_unit IU  where I.unit_id=IU.unit_id AND I.Item_id = ", intItemId);
            return this.DBUtil.GetDataTable(str);
        }

        public DataSet getItemTaxvalues(int intItemId)
        {
            string str = "";
            str = string.Concat(" select   i.hs_code AS HS_Code,i.item_name as Item,iu.unit_name as Unit,itc.tax_code,itv.tax_value, to_char(itv.date_effective, 'dd Mon yy') date_effective\r\n from item_tax_values itv,Item i,item_tax_category itc ,item_unit iu \r\n where itv.Item_id=i.Item_id And itv.tax_id=itc.tax_id and i.unit_id=iu.unit_id and itv.Is_deleted=false and itv.Item_id=", intItemId, " \r\n and tax_value_id in ( select max(tax_value_id) from item_tax_values where Item_id=itv.Item_id and tax_id = itv.tax_id)\r\n group by   itv.tax_value_id, i.hs_code ,i.item_name ,iu.unit_name ,itc.tax_code,  itv.tax_value,itv.date_effective\r\n order by itv.date_insert");
            return this.DBUtil.GetDataSet(str, "ItemTaxvalues");
        }

        public DataTable getTaxValuesByItemId(int ItemId, string trnType)
        {
            string str = "";
            if (trnType == "Local Purchase")
            {
                str = "and is_tran_local=true";
            }
            if (trnType == "Imported")
            {
                str = "and is_tran_import=true";
            }
            if (trnType == "Sale")
            {
                str = "and is_tran_sale=true";
            }
            object[] itemId = new object[] { "select * from item_tax_values where Item_id='", ItemId, "' and Is_deleted=false ", str };
            string str1 = string.Concat(itemId);
            return this.DBUtil.GetDataTable(str1);
        }

        public DataTable getTaxValuesByItemIdAndTaxId(short ItemId, short tax_id)
        {
            object[] itemId = new object[] { "select * from item_tax_values where Item_id='", ItemId, "' and tax_id='", tax_id, "' and is_current=true and Is_deleted=false and tax_value!=0 order by tax_id" };
            string str = string.Concat(itemId);
            return this.DBUtil.GetDataTable(str);
        }

        public DataTable getTaxValuesByItemIdAndTaxIdForImport(short ItemId, short tax_id)
        {
            object[] itemId = new object[] { "select * from item_tax_values where Item_id='", ItemId, "' and tax_id='", tax_id, "' and is_current=true and Is_deleted=false AND is_tran_import=true and tax_value!=0 order by tax_id" };
            string str = string.Concat(itemId);
            return this.DBUtil.GetDataTable(str);
        }

        public bool insertInsertItemTaxValue(ItemTaxValueDAO objItemTaxValues, bool isCurrent)
        {
            bool flag;
            try
            {
                string str = "";
                str = string.Concat("select * from item_tax_values WHERE item_id = ", objItemTaxValues.ItemID, " AND is_deleted  = false");
                DataTable dataTable = this.DBUtil.GetDataTable(str);
                ArrayList arrayLists = new ArrayList();
                if (objItemTaxValues.TranLocal)
                {
                    object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_local=true" };
                    arrayLists.Add(string.Concat(itemID));
                    object[] objArray = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_local=true" };
                    arrayLists.Add(string.Concat(objArray));
                }
                if (objItemTaxValues.TranImported)
                {
                    object[] itemID1 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_import=true" };
                    arrayLists.Add(string.Concat(itemID1));
                    object[] objArray1 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_import=true" };
                    arrayLists.Add(string.Concat(objArray1));
                }
                if (objItemTaxValues.TranSale)
                {
                    object[] itemID2 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_sale=true" };
                    arrayLists.Add(string.Concat(itemID2));
                    object[] objArray2 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_sale=true" };
                    arrayLists.Add(string.Concat(objArray2));
                }
                if (objItemTaxValues.TrantradePrice)
                {
                    object[] itemID3 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_trade_price=true" };
                    arrayLists.Add(string.Concat(itemID3));
                    object[] objArray3 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_trade_price=true" };
                    arrayLists.Add(string.Concat(objArray3));
                }
                if (dataTable.Rows.Count <= 0)
                {
                    object[] itemID4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,is_last_insert,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',1, ", isCurrent, ",", objItemTaxValues.Is_last_insert, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.IsfxdCD, ")" };
                    arrayLists.Add(string.Concat(itemID4));
                }
                else
                {
                    object[] objArray4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,date_update,User_id_update,is_last_insert,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',", objItemTaxValues.EmpID, ", ", isCurrent, ", to_timestamp('", DateTime.Now.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'), ", objItemTaxValues.EmpID, ",", objItemTaxValues.Is_last_insert, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.IsfxdCD, ")" };
                    arrayLists.Add(string.Concat(objArray4));
                }
                flag = this.DBUtil.ExecuteBatchDML(arrayLists);
            }
            catch (Exception exception)
            {
                throw exception;
            }
            return flag;
        }

        public bool insertInsertItemTaxValueANNX(ItemTaxValueDAO objItemTaxValues)
        {
            string empty = string.Empty;
            bool flag = false;
            object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true" };
            string.Concat(itemID);
            flag = this.DBUtil.ExecuteDML(empty);
            object[] str = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value, is_annx,User_id_insert,is_current) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", null, null, null, null, null, null, null, null };
            str[5] = objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm");
            str[6] = "','MM/dd/yyyy HH24:MI'),' ";
            str[7] = objItemTaxValues.TaxValue;
            str[8] = "',true,";
            str[9] = objItemTaxValues.EmpID;
            str[10] = ",";
            str[11] = true;
            str[12] = ")";
            empty = string.Concat(str);
            return this.DBUtil.ExecuteDML(empty);
        }

        public bool insertInsertItemTaxValueANNXDeselect(ItemTaxValueDAO objItemTaxValues)
        {
            string empty = string.Empty;
            bool flag = false;
            object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID };
            string str = string.Concat(itemID);
            flag = this.DBUtil.ExecuteDML(str);
            object[] taxValue = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value, is_annx,User_id_insert,is_current) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", null, null, null, null, null, null, null, null };
            taxValue[5] = objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm");
            taxValue[6] = "','MM/dd/yyyy HH24:MI'),' ";
            taxValue[7] = objItemTaxValues.TaxValue;
            taxValue[8] = "',false,";
            taxValue[9] = objItemTaxValues.EmpID;
            taxValue[10] = ",";
            taxValue[11] = false;
            taxValue[12] = ")";
            empty = string.Concat(taxValue);
            return this.DBUtil.ExecuteDML(empty);
        }

        public bool insertInsertItemTaxValueLimit(ItemTaxValueDAO objItemTaxValues, bool isCurrent)
        {
            string str = "";
            str = string.Concat("select * from item_tax_values WHERE item_id = ", objItemTaxValues.ItemID, " AND is_deleted  = false");
            DataTable dataTable = this.DBUtil.GetDataTable(str);
            ArrayList arrayLists = new ArrayList();
            if (objItemTaxValues.TranLocal)
            {
                object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_local=true" };
                arrayLists.Add(string.Concat(itemID));
                object[] objArray = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_local=true" };
                arrayLists.Add(string.Concat(objArray));
            }
            if (objItemTaxValues.TranImported)
            {
                object[] itemID1 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_import=true" };
                arrayLists.Add(string.Concat(itemID1));
                object[] objArray1 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_import=true" };
                arrayLists.Add(string.Concat(objArray1));
            }
            if (objItemTaxValues.TranSale)
            {
                object[] itemID2 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_sale=true" };
                arrayLists.Add(string.Concat(itemID2));
                object[] objArray2 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_sale=true" };
                arrayLists.Add(string.Concat(objArray2));
            }
            if (objItemTaxValues.TrantradePrice)
            {
                object[] itemID3 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_trade_price=true" };
                arrayLists.Add(string.Concat(itemID3));
                object[] objArray3 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_trade_price=true" };
                arrayLists.Add(string.Concat(objArray3));
            }
            if (dataTable.Rows.Count <= 0)
            {
                object[] itemID4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,is_last_insert,upper_limit,lower_limit,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,level,packet_category,health_surcharge,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',1, ", isCurrent, ",", objItemTaxValues.Is_last_insert, ",", objItemTaxValues.dUpper, ",", objItemTaxValues.dLower, ",", objItemTaxValues.IsAnnx, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.LevelId, ",", objItemTaxValues.PacketId, ",", objItemTaxValues.Healthcharge, ",", objItemTaxValues.IsfxdCD, ")" };
                arrayLists.Add(string.Concat(itemID4));
            }
            else
            {
                object[] objArray4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,date_update,User_id_update,is_last_insert,upper_limit,lower_limit,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,level,packet_category,health_surcharge,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',", objItemTaxValues.EmpID, ", \r\n                       ", isCurrent, ", to_timestamp('", DateTime.Now.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'), ", objItemTaxValues.EmpID, ",", objItemTaxValues.Is_last_insert, ",", objItemTaxValues.dUpper, ",", objItemTaxValues.dLower, ",\r\n                       ", objItemTaxValues.IsAnnx, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.LevelId, ",", objItemTaxValues.PacketId, ",", objItemTaxValues.Healthcharge, ",", objItemTaxValues.IsfxdCD, ")" };
                arrayLists.Add(string.Concat(objArray4));
            }
            return this.DBUtil.ExecuteBatchDML(arrayLists);
        }

        public bool insertInsertItemTaxValueLimitTobacco(ArrayList arrDeailDAO, bool isCurrent)
        {
            string str = "";
            ArrayList arrayLists = new ArrayList();
            for (int i = 0; i < arrDeailDAO.Count; i++)
            {
                ItemTaxValueDAO itemTaxValueDAO = new ItemTaxValueDAO();
                itemTaxValueDAO = (ItemTaxValueDAO)arrDeailDAO[i];
                str = string.Concat("select * from item_tax_values WHERE item_id = ", itemTaxValueDAO.ItemID, " AND is_deleted  = false");
                DataTable dataTable = this.DBUtil.GetDataTable(str);
                if (itemTaxValueDAO.TranLocal)
                {
                    object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, " and is_current = true AND is_tran_local=true" };
                    arrayLists.Add(string.Concat(itemID));
                    object[] objArray = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, "and is_last_insert = true AND is_tran_local=true" };
                    arrayLists.Add(string.Concat(objArray));
                }
                if (itemTaxValueDAO.TranImported)
                {
                    object[] itemID1 = new object[] { "update item_tax_values set is_current = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, " and is_current = true AND is_tran_import=true" };
                    arrayLists.Add(string.Concat(itemID1));
                    object[] objArray1 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, "and is_last_insert = true AND is_tran_import=true" };
                    arrayLists.Add(string.Concat(objArray1));
                }
                if (itemTaxValueDAO.TranSale)
                {
                    object[] itemID2 = new object[] { "update item_tax_values set is_current = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, " and is_current = true AND is_tran_sale=true" };
                    arrayLists.Add(string.Concat(itemID2));
                    object[] objArray2 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, "and is_last_insert = true AND is_tran_sale=true" };
                    arrayLists.Add(string.Concat(objArray2));
                }
                if (itemTaxValueDAO.TrantradePrice)
                {
                    object[] itemID3 = new object[] { "update item_tax_values set is_current = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, " and is_current = true AND is_trade_price=true" };
                    arrayLists.Add(string.Concat(itemID3));
                    object[] objArray3 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", itemTaxValueDAO.ItemID, "  and tax_id = ", itemTaxValueDAO.TaxID, "and is_last_insert = true AND is_trade_price=true" };
                    arrayLists.Add(string.Concat(objArray3));
                }
                if (dataTable.Rows.Count <= 0)
                {
                    object[] itemID4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,is_last_insert,upper_limit,lower_limit,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,level,packet_category,health_surcharge) VALUES   ( '", itemTaxValueDAO.ItemID, "',' ", itemTaxValueDAO.TaxID, "',to_timestamp('", itemTaxValueDAO.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", itemTaxValueDAO.TaxValue, "',1, ", isCurrent, ",", itemTaxValueDAO.Is_last_insert, ",", itemTaxValueDAO.dUpper, ",", itemTaxValueDAO.dLower, ",", itemTaxValueDAO.IsAnnx, ",", itemTaxValueDAO.TranLocal, ",", itemTaxValueDAO.TranImported, ",", itemTaxValueDAO.TranSale, ",", itemTaxValueDAO.TrantradePrice, ",", itemTaxValueDAO.LevelId, ",", itemTaxValueDAO.PacketId, ",", itemTaxValueDAO.Healthcharge, ")" };
                    arrayLists.Add(string.Concat(itemID4));
                }
                else
                {
                    object[] objArray4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,date_update,User_id_update,is_last_insert,upper_limit,lower_limit,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,level,packet_category,health_surcharge) VALUES   ( '", itemTaxValueDAO.ItemID, "',' ", itemTaxValueDAO.TaxID, "',to_timestamp('", itemTaxValueDAO.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", itemTaxValueDAO.TaxValue, "',", itemTaxValueDAO.EmpID, ", \r\n                       ", isCurrent, ", to_timestamp('", DateTime.Now.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'), ", itemTaxValueDAO.EmpID, ",", itemTaxValueDAO.Is_last_insert, ",", itemTaxValueDAO.dUpper, ",", itemTaxValueDAO.dLower, ",\r\n                       ", itemTaxValueDAO.IsAnnx, ",", itemTaxValueDAO.TranLocal, ",", itemTaxValueDAO.TranImported, ",", itemTaxValueDAO.TranSale, ",", itemTaxValueDAO.TrantradePrice, ",", itemTaxValueDAO.LevelId, ",", itemTaxValueDAO.PacketId, ",", itemTaxValueDAO.Healthcharge, ")" };
                    arrayLists.Add(string.Concat(objArray4));
                }
            }
            return this.DBUtil.ExecuteBatchDML(arrayLists);
        }

        public bool insertInsertItemTaxValuePer(ItemTaxValueDAO objItemTaxValues, bool isCurrent)
        {
            string str = "";
            str = string.Concat("select * from item_tax_values WHERE item_id = ", objItemTaxValues.ItemID, " AND is_deleted  = false");
            DataTable dataTable = this.DBUtil.GetDataTable(str);
            ArrayList arrayLists = new ArrayList();
            if (objItemTaxValues.TranLocal)
            {
                object[] itemID = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_local=true" };
                arrayLists.Add(string.Concat(itemID));
                object[] objArray = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_local=true" };
                arrayLists.Add(string.Concat(objArray));
            }
            if (objItemTaxValues.TranImported)
            {
                object[] itemID1 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_import=true" };
                arrayLists.Add(string.Concat(itemID1));
                object[] objArray1 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_import=true" };
                arrayLists.Add(string.Concat(objArray1));
            }
            if (objItemTaxValues.TranSale)
            {
                object[] itemID2 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_tran_sale=true" };
                arrayLists.Add(string.Concat(itemID2));
                object[] objArray2 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_tran_sale=true" };
                arrayLists.Add(string.Concat(objArray2));
            }
            if (objItemTaxValues.TrantradePrice)
            {
                object[] itemID3 = new object[] { "update item_tax_values set is_current = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, " and is_current = true AND is_trade_price=true" };
                arrayLists.Add(string.Concat(itemID3));
                object[] objArray3 = new object[] { "update item_tax_values set is_last_insert = false where Item_id =", objItemTaxValues.ItemID, "  and tax_id = ", objItemTaxValues.TaxID, "and is_last_insert = true AND is_trade_price=true" };
                arrayLists.Add(string.Concat(objArray3));
            }
            if (dataTable.Rows.Count <= 0)
            {
                object[] itemID4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,is_last_insert,per,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',1, ", isCurrent, ",", objItemTaxValues.Is_last_insert, ",'", objItemTaxValues.TaxPer, "',", objItemTaxValues.IsAnnx, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.IsfxdCD, ")" };
                arrayLists.Add(string.Concat(itemID4));
            }
            else
            {
                object[] objArray4 = new object[] { "INSERT INTO item_tax_values (Item_id,tax_id,date_effective,tax_value,User_id_insert, is_current,date_update,User_id_update,is_last_insert,per,is_annx,is_tran_local,is_tran_import,is_tran_sale,is_trade_price,is_fixed_cd) VALUES   ( '", objItemTaxValues.ItemID, "',' ", objItemTaxValues.TaxID, "',to_timestamp('", objItemTaxValues.DateOfEffective.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'),' ", objItemTaxValues.TaxValue, "',", objItemTaxValues.EmpID, ", ", isCurrent, ", to_timestamp('", DateTime.Now.ToString("MM/dd/yyyy HH:mm"), "','MM/dd/yyyy HH24:MI'), ", objItemTaxValues.EmpID, ",", objItemTaxValues.Is_last_insert, ",'", objItemTaxValues.TaxPer, "',", objItemTaxValues.IsAnnx, ",", objItemTaxValues.TranLocal, ",", objItemTaxValues.TranImported, ",", objItemTaxValues.TranSale, ",", objItemTaxValues.TrantradePrice, ",", objItemTaxValues.IsfxdCD, ")" };
                arrayLists.Add(string.Concat(objArray4));
            }
            return this.DBUtil.ExecuteBatchDML(arrayLists);
        }

        public DataTable LoadinsertDateValue(int Item_id)
        {
            DataTable dataTable = new DataTable();
            string str = string.Concat("select date_insert from item_tax_values WHERE item_id = ", Item_id, " order by date_insert desc limit 1");
            return this.DBUtil.GetDataTable(str);
        }

        public DataTable LoadUniqueValue(int Item_id, int tax_id, string date_effective, bool bImport, bool bLocalPurchase, bool bSale, bool isTrdPrc)
        {
            DataTable dataTable = new DataTable();
            if (date_effective.Length <= 0)
            {
                return dataTable;
            }
            string str = "";
            if (bImport)
            {
                object[] itemId = new object[] { "select * from item_tax_values WHERE Item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_tran_import=", bImport, " AND date_effective = '", DateTime.ParseExact(date_effective, "dd/MM/yyyy", null), "'" };
                str = string.Concat(itemId);
            }
            if (bLocalPurchase)
            {
                object[] objArray = new object[] { "select * from item_tax_values WHERE Item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_tran_local=", bLocalPurchase, " AND date_effective = '", DateTime.ParseExact(date_effective, "dd/MM/yyyy", null), "'" };
                str = string.Concat(objArray);
            }
            if (bSale)
            {
                object[] itemId1 = new object[] { "select * from item_tax_values WHERE Item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_tran_sale=", bSale, " AND date_effective = '", DateTime.ParseExact(date_effective, "dd/MM/yyyy", null), "'" };
                str = string.Concat(itemId1);
            }
            if (isTrdPrc)
            {
                object[] objArray1 = new object[] { "select * from item_tax_values WHERE Item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_trade_price=", isTrdPrc, " AND date_effective = '", DateTime.ParseExact(date_effective, "dd/MM/yyyy", null), "'" };
                str = string.Concat(objArray1);
            }
            dataTable = this.DBUtil.GetDataTable(str);
            return dataTable;
        }

        public DataTable LoadUnit(int intItemId)
        {
            string str = string.Concat("select 1 as tax_id,i.unit_id,iu.unit_name, '' as per,0 as vat_amount from item i inner join item_unit iu on i.unit_id=iu.unit_id where i.item_id=", intItemId);
            return this.DBUtil.GetDataTable(str);
        }

        public bool UpdteItemTaxValues(int Item_id, int tax_id, double value, DateTime effectiveDate, int empID, bool lcl, bool imp, bool sale, bool tPrice, bool chkFdCD)
        {
            DataTable dataTable = new DataTable();
            bool flag = false;
            if (value < 0)
            {
                object[] objArray = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = false ,is_fixed_cd=", chkFdCD, ", user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true" };
                string str = string.Concat(objArray);
                flag = this.DBUtil.ExecuteDML(str);
            }
            else
            {
                string str1 = "";
                if (lcl)
                {
                    object[] objArray1 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true,is_fixed_cd=", chkFdCD, ", user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_local=true" };
                    str1 = string.Concat(objArray1);
                }
                if (imp)
                {
                    object[] objArray2 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true,is_fixed_cd=", chkFdCD, ", user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_import=true" };
                    str1 = string.Concat(objArray2);
                }
                if (sale)
                {
                    object[] objArray3 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true ,is_fixed_cd=", chkFdCD, ", user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_sale=true" };
                    str1 = string.Concat(objArray3);
                }
                if (tPrice)
                {
                    object[] objArray4 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true ,is_fixed_cd=", chkFdCD, ", user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_trade_price = true" };
                    str1 = string.Concat(objArray4);
                }
                flag = this.DBUtil.ExecuteDML(str1);
            }
            return flag;
        }

        public bool UpdteItemTaxValuesLimit(int Item_id, int tax_id, double taxValue, decimal upperLimit, decimal lowerLimit, DateTime effectiveDate, int empID, bool lcl, bool imp, bool sale, bool tprice)
        {
            DataTable dataTable = new DataTable();
            bool flag = false;
            if (!(upperLimit > new decimal(0)) || !(lowerLimit > new decimal(0)))
            {
                object[] objArray = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, "is_current = false, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true" };
                string str = string.Concat(objArray);
                flag = this.DBUtil.ExecuteDML(str);
            }
            else
            {
                string str1 = "";
                if (lcl)
                {
                    object[] objArray1 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_local=true" };
                    str1 = string.Concat(objArray1);
                }
                if (imp)
                {
                    object[] objArray2 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_import=true" };
                    str1 = string.Concat(objArray2);
                }
                if (sale)
                {
                    object[] objArray3 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_sale=true" };
                    str1 = string.Concat(objArray3);
                }
                if (tprice)
                {
                    object[] objArray4 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_trade_price=true" };
                    str1 = string.Concat(objArray4);
                }
                flag = this.DBUtil.ExecuteDML(str1);
            }
            return flag;
        }

        public bool UpdteItemTaxValuesLimitTobacco(int Item_id, int tax_id, double taxValue, double sdValue, int levelId, double hlthCharge, decimal upperLimit, decimal lowerLimit, DateTime effectiveDate, int empID, bool lcl, bool imp, bool sale, bool tprice)
        {
            DataTable dataTable = new DataTable();
            bool flag = false;
            if (!(upperLimit > new decimal(0)) || !(lowerLimit > new decimal(0)))
            {
                object[] objArray = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, "is_current = false, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true" };
                string str = string.Concat(objArray);
                flag = this.DBUtil.ExecuteDML(str);
            }
            else
            {
                string str1 = "";
                if (lcl)
                {
                    object[] objArray1 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_local=true" };
                    str1 = string.Concat(objArray1);
                }
                if (imp)
                {
                    object[] objArray2 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_import=true" };
                    str1 = string.Concat(objArray2);
                }
                if (sale)
                {
                    object[] objArray3 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_sale=true" };
                    str1 = string.Concat(objArray3);
                }
                if (tprice)
                {
                    object[] objArray4 = new object[] { "update item_tax_values set tax_value = ", taxValue, ", upper_limit = ", upperLimit, ",lower_limit= ", lowerLimit, ",is_current = true, user_id_update = ", empID, "  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_trade_price=true" };
                    str1 = string.Concat(objArray4);
                }
                flag = this.DBUtil.ExecuteDML(str1);
            }
            return flag;
        }

        public bool UpdteItemTaxValuesPer(int Item_id, int tax_id, string perValue, double value, DateTime effectiveDate, int empID, bool lcl, bool imp, bool sale, bool tprice)
        {
            DataTable dataTable = new DataTable();
            bool flag = false;
            if (value <= 0)
            {
                object[] objArray = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = false, user_id_update = ", empID, ", per = '", perValue, "'  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true" };
                string str = string.Concat(objArray);
                flag = this.DBUtil.ExecuteDML(str);
            }
            else
            {
                string str1 = "";
                if (lcl)
                {
                    object[] objArray1 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true, user_id_update = ", empID, ", per = '", perValue, "'  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_local=true" };
                    str1 = string.Concat(objArray1);
                }
                if (imp)
                {
                    object[] objArray2 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true, user_id_update = ", empID, ", per = '", perValue, "'  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_import=true" };
                    str1 = string.Concat(objArray2);
                }
                if (sale)
                {
                    object[] objArray3 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true, user_id_update = ", empID, ", per = '", perValue, "'  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_tran_sale=true" };
                    str1 = string.Concat(objArray3);
                }
                if (tprice)
                {
                    object[] objArray4 = new object[] { "update item_tax_values set tax_value = ", value, ",is_current = true, user_id_update = ", empID, ", per = '", perValue, "'  Where item_id = ", Item_id, " AND tax_id = ", tax_id, " AND is_deleted = false AND is_last_insert = true AND is_trade_price=true" };
                    str1 = string.Concat(objArray4);
                }
                flag = this.DBUtil.ExecuteDML(str1);
            }
            return flag;
        }
    }
}
